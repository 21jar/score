<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="${request.contextPath}/statics/libs/jquery.min.js"></script>

    <style type="text/css">
        body, html {
            margin-top: 200px;
        }
        .judges {
            width: 20%;    /*这里是百分比或者像素值，对应下面的center就是百分比或者像素值*/
            height: 200px;
            float: left;
            text-align:center;
        }
    </style>
</head>
<body >
<img src="/statics/images/beijing.jpg" width="100%" height="100%" style="z-index:-100;position:absolute;left:0;top:0">
<div class="main" >

    <div id="middle">
        <div class="judges">
            评委1<br>
            <span id="grade1"></span>
        </div>
        <div class="judges">
            评委2<br>
            <span id="grade2"></span>
        </div>
        <div class="judges">
            评委3<br>
            <span id="grade3"></span>
        </div>
        <div class="judges">
            评委4<br>
            <span id="grade4"></span>
        </div>
        <div class="judges">
            评委5<br>
            <span id="grade5"></span>
        </div>
    </div>

</div>
</body>

<script type="text/javascript">
    var ws = null;
    var ws_status = false;
    function openWebSocket(){
        //判断当前浏览器是否支持WebSocket
        if ('WebSocket' in window) {
            ws = new WebSocket("ws://"+window.location.host+"/websocket/11");
        } else if ('MozWebSocket' in window) {
            websocket = new MozWebSocket("ws://"+window.location.host+"/websocket/11");
        } else {
            ws = new SockJS("http://"+window.location.host+"/websocket/11");
        }
        ws.onopen = function () {

        };
        //这个事件是接受后端传过来的数据
        ws.onmessage = function (event) {
            //根据业务逻辑解析数据
            console.log("Server:");
            console.log(event);
            var parsedJson = jQuery.parseJSON(event.data);
            $("#grade1").text(parsedJson.grade1);
            $("#grade2").text(parsedJson.grade2);
            $("#grade3").text(parsedJson.grade3);
            $("#grade4").text(parsedJson.grade4);
            $("#grade5").text(parsedJson.grade5);

        };
        ws.onclose = function (event) {
            console.log("Connection closed!");
        };
        ws.onopen = function (event){
            ws_status = true;
            console.log("Connected!");
        };
        ws.onerror = function (event){
            console.log("Connect error!");
        };
    }
    //如果连接失败，每隔两秒尝试重新连接
    setInterval(function(){
        if(!ws_status){
            openWebSocket();
        }
    }, 2000);
    $("#send").click(function(){
        ws.send("Hello, server, I am browser.");
    });
</script>
</html>